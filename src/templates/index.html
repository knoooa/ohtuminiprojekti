{% extends "layout.html" %}

{% block title %}Add a new Citation{% endblock %}

{% block body %}
<h1>ðŸ“š Citation Manager</h1>
<div class="nav-links">
  <a href="{{ url_for('citations_view') }}">View All Citations</a>
  <a href="{{ url_for('citations_search') }}">Search Citations</a>
</div>

<h2>Create a New Citation</h2>
<p>Select an entry type and fill in the citation details below.</p>

<form method="post">
  <label>Entry Type:
    <select name="entry_type" required>
      <option value="" disabled selected>Select a citation type</option>
      {% for et in entry_types or [] %}
      {% if et.id == session.get("entry_type", {}).get("id") %}
      <option value="{{ et.id }}" selected>{{ et.name }}</option>
      {% else %}
      <option value="{{ et.id }}">{{ et.name }}</option>
      {% endif %}
      {% endfor %}
    </select>
  </label>
  <button type="submit">Select Type</button>
</form>

{% if session.get("entry_type") %}
<hr>
<form method="post">
  <h2>Entry Type: <strong>{{ session.get("entry_type").get("name") }}</strong></h2>
  <h3>Citation Details</h3>
  <label>Citation Key (Required):
    <input type="text" name="citation_key" required placeholder="e.g., doe2020">
  </label>
  {% for f in fields %}
  <label>{{ f.replace("_", " ").capitalize() }}:
    <input type="text" name="{{ f }}" placeholder="Enter {{ f.replace('_', ' ') }}">
  </label>
  {% endfor %}
  <div style="margin-top: 20px;">
    <button type="submit" class="btn-success">Add Citation</button>
  </div>
</form>
{% endif %}
{% endblock %}
